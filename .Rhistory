title: "R Notebook"
#Importing the data using data.table
library(data.table)
library(dplyr)
df1 = fread("/home/aishwarya/Documents/Academia/Sem 5/DA/Assignment1/hr-analytics-case-study/general_data.csv")
df2 = fread("/home/aishwarya/Documents/Academia/Sem 5/DA/Assignment1/hr-analytics-case-study/manager_survey_data.csv")
df3 = fread("/home/aishwarya/Documents/Academia/Sem 5/DA/Assignment1/hr-analytics-case-study/employee_survey_data.csv")
df1 = na.omit(df1)
df2 = na.omit(df2)
df3 = na.omit(df3)
df <- merge(df1, df2, by="EmployeeID")
data <- merge(df, df3, by="EmployeeID")
hist(data$Age,
breaks = c(10, 20, 30, 40, 50, 60, 70, 80),
right=FALSE,
xlab="Age",
main="Histogram of Age",
xlim = c(20, 70),
col="cornflowerblue"
)
paste("Right Skewed Graph, Unimodal")
l <- tapply(data$MonthlyIncome, cut(data$Age, seq(9, 70, by=10)), mean)
which.max(l)
salary_max <- filter(data, Age <=49, Age>=40)
max_salary <- head(salary_max[unique(order(salary_max$MonthlyIncome, decreasing = TRUE)), ], n=5)
max_salary[c("EmployeeID", "MonthlyIncome", "TotalWorkingYears")]
library(plyr)
z <- ddply(salary_max, .(JobRole), summarize,  Average=mean(MonthlyIncome))
par(mar=c(7,4,4,2)+0.1,mgp=c(4,1,0))
barplot(z$Average, names.arg = z$JobRole, ylab="Average Monthly Income", main = "Job Role Vs Average Salary", cex.names=0.6, las=2, col ="cornflowerblue")
library(dplyr)
female_data <- filter(data, Gender=="Female")
d1 <- female_data %>% select(MaritalStatus, EnvironmentSatisfaction)
l1 = unique(d1$EnvironmentSatisfaction)
new_data1 <- table(d1$MaritalStatus, d1$EnvironmentSatisfaction)
cols <- c("red", "blue", "green")
barplot(new_data1, main="Environment Satisfaction in Females", col=cols,
xlab="Environment Satisfaction",
beside=TRUE)
legend("topleft",
title="Marital Status",
legend=c(rownames(new_data1)),
fill=cols
)
library(dplyr)
d1 <- data %>% select(Attrition, Department)
z = list()
dept_list = unique(d1$Department)
for (variable in dept_list) {
x <- filter(d1, Department==variable)
n  = nrow(x)
y <- filter(x, Attrition=="Yes")
attrition = nrow(y)
z[variable] = attrition/n
}
print("Least Attrition=")
which.min(z)
library(dplyr)
d1 <- data %>% select(EducationField, MonthlyIncome)
par(mar=c(5,6,1,0)+0.1,mgp=c(4,1,0))
par(cex.axis=0.6)
boxplot(MonthlyIncome ~ EducationField, data = d1, ylab = "Monthly Income", main = "Box Plots for Monthly Income ", boxwex=0.3, las=2, cex.names=0.2)
education_fields = unique(data$EducationField)
d1 <- data %>% select(EducationField, MonthlyIncome, Gender)
for(variable in education_fields)
{
x <- filter(d1, EducationField==variable)
print(variable)
print(summary(x$MonthlyIncome))
#print(quantile(x$MonthlyIncome, c(.95)))
#print("IQR")
print(IQR(x$MonthlyIncome))
}
d2 <- data %>% select(Gender, MonthlyIncome)
par(mar=c(5,6,0,0)+0.1,mgp=c(4,1,0))
boxplot(MonthlyIncome ~ Gender, data = d2, xlab = "Gender",
ylab = "Monthly Income", main = "B", cex.names=0.3, las=2)
print("As seen from the box plot, the gender wage gap isn't prominent. The median pay for both male and female is slightly higher in women by 280. The Mean salary for men is greater than the mean salary for women by 724.")
men <- filter(d2, Gender=="Male")
summary(men$MonthlyIncome)
women <- filter(d2, Gender=="Female")
summary(women$MonthlyIncome)
x <- filter(d1, EducationField=="Medical")
print(quantile(x$MonthlyIncome, c(.95)))
library(moments)
library(PerformanceAnalytics)
print("Skewness is a measure of the symmetry in a distribution.  A symmetrical dataset will have a skewness equal to 0.  So, a normal distribution will have a skewness of 0.   Skewness essentially measures the relative size of the two tails. ")
skewness(data$MonthlyIncome)
print("Kurtosis is a measure of the combined sizes of the two tails.  It measures the amount of probability in the tails.  The value is often compared to the kurtosis of the normal distribution, which is equal to 3.  If the kurtosis is greater than 3, then the dataset has heavier tails than a normal distribution (more in the tails).  If the kurtosis is less than 3, then the dataset has lighter tails than a normal distribution (less in the tails).")
kurtosis(data$MonthlyIncome)
library(dplyr)
Modes <- function(x) {
ux <- unique(x)
tab <- tabulate(match(x, ux))
ux[tab == max(tab)]
}
d1 <- data %>% select(EducationField, MonthlyIncome)
par(mar=c(5,6,1,0)+0.1,mgp=c(4,1,0))
par(cex.axis=0.6)
boxplot(MonthlyIncome ~ EducationField, data = d1, ylab = "Monthly Income", main = "Box Plots for Monthly Income ", boxwex=0.3, las=2, cex.names=0.2)
education_fields = unique(data$EducationField)
d1 <- data %>% select(EducationField, MonthlyIncome, Gender)
for(variable in education_fields)
{
x <- filter(d1, EducationField==variable)
print(variable)
print(summary(x$MonthlyIncome))
print(Modes(x$MonthlyIncome))
#print("IQR")
print(IQR(x$MonthlyIncome))
}
library(dplyr)
Modes <- function(x) {
ux <- unique(x)
tab <- tabulate(match(x, ux))
ux[tab == max(tab)]
}
d1 <- data %>% select(EducationField, MonthlyIncome)
par(mar=c(5,6,1,0)+0.1,mgp=c(4,1,0))
par(cex.axis=0.6)
boxplot(MonthlyIncome ~ EducationField, data = d1, ylab = "Monthly Income", main = "Box Plots for Monthly Income ", boxwex=0.3, las=2, cex.names=0.2)
education_fields = unique(data$EducationField)
d1 <- data %>% select(EducationField, MonthlyIncome, Gender)
for(variable in education_fields)
{
x <- filter(d1, EducationField==variable)
print(variable)
print(summary(x$MonthlyIncome))
cat("Modes", Modes(x$MonthlyIncome))
#print("IQR")
print(IQR(x$MonthlyIncome))
}
library(dplyr)
Modes <- function(x) {
ux <- unique(x)
tab <- tabulate(match(x, ux))
ux[tab == max(tab)]
}
d1 <- data %>% select(EducationField, MonthlyIncome)
par(mar=c(5,6,1,0)+0.1,mgp=c(4,1,0))
par(cex.axis=0.6)
boxplot(MonthlyIncome ~ EducationField, data = d1, ylab = "Monthly Income", main = "Box Plots for Monthly Income ", boxwex=0.3, las=2, cex.names=0.2)
education_fields = unique(data$EducationField)
d1 <- data %>% select(EducationField, MonthlyIncome, Gender)
for(variable in education_fields)
{
x <- filter(d1, EducationField==variable)
print(variable)
print(summary(x$MonthlyIncome))
cat("Modes \n", Modes(x$MonthlyIncome))
#print("IQR")
print(IQR(x$MonthlyIncome))
}
library(dplyr)
Modes <- function(x) {
ux <- unique(x)
tab <- tabulate(match(x, ux))
ux[tab == max(tab)]
}
d1 <- data %>% select(EducationField, MonthlyIncome)
par(mar=c(5,6,1,0)+0.1,mgp=c(4,1,0))
par(cex.axis=0.6)
boxplot(MonthlyIncome ~ EducationField, data = d1, ylab = "Monthly Income", main = "Box Plots for Monthly Income ", boxwex=0.3, las=2, cex.names=0.2)
education_fields = unique(data$EducationField)
d1 <- data %>% select(EducationField, MonthlyIncome, Gender)
for(variable in education_fields)
{
x <- filter(d1, EducationField==variable)
print(variable)
print(summary(x$MonthlyIncome))
cat("Modes = ", Modes(x$MonthlyIncome))
cat("IQR = ", IQR(x$MonthlyIncome), "\n\n")
}
library(dplyr)
Modes <- function(x) {
ux <- unique(x)
tab <- tabulate(match(x, ux))
ux[tab == max(tab)]
}
d1 <- data %>% select(EducationField, MonthlyIncome)
par(mar=c(5,6,1,0)+0.1,mgp=c(4,1,0))
par(cex.axis=0.6)
boxplot(MonthlyIncome ~ EducationField, data = d1, ylab = "Monthly Income", main = "Box Plots for Monthly Income ", boxwex=0.3, las=2, cex.names=0.2)
education_fields = unique(data$EducationField)
d1 <- data %>% select(EducationField, MonthlyIncome, Gender)
for(variable in education_fields)
{
x <- filter(d1, EducationField==variable)
print(variable)
print(summary(x$MonthlyIncome))
cat("Modes = ", Modes(x$MonthlyIncome), "\n")
cat("IQR = ", IQR(x$MonthlyIncome), "\n\n")
}
library(moments)
library(PerformanceAnalytics)
hist(data$MonthlyIncome)
print("Skewness is a measure of the symmetry in a distribution.  A symmetrical dataset will have a skewness equal to 0.  So, a normal distribution will have a skewness of 0.   Skewness essentially measures the relative size of the two tails. ")
skewness(data$MonthlyIncome)
print("Kurtosis is a measure of the combined sizes of the two tails.  It measures the amount of probability in the tails.  The value is often compared to the kurtosis of the normal distribution, which is equal to 3.  If the kurtosis is greater than 3, then the dataset has heavier tails than a normal distribution (more in the tails).  If the kurtosis is less than 3, then the dataset has lighter tails than a normal distribution (less in the tails).")
kurtosis(data$MonthlyIncome)
#Importing the data using data.table
library(data.table)
library(dplyr)
df1 = fread("/home/aishwarya/Documents/Academia/Sem 5/DA/Assignment1/hr-analytics-case-study/general_data.csv")
df2 = fread("/home/aishwarya/Documents/Academia/Sem 5/DA/Assignment1/hr-analytics-case-study/manager_survey_data.csv")
df3 = fread("/home/aishwarya/Documents/Academia/Sem 5/DA/Assignment1/hr-analytics-case-study/employee_survey_data.csv")
df1 = na.omit(df1)
df2 = na.omit(df2)
df3 = na.omit(df3)
df <- merge(df1, df2, by="EmployeeID")
data <- merge(df, df3, by="EmployeeID")
hist(data$Age,
breaks = c(10, 20, 30, 40, 50, 60, 70, 80),
right=FALSE,
xlab="Age",
main="Histogram of Age",
xlim = c(20, 70),
col="cornflowerblue"
)
paste("Right Skewed Graph, Unimodal")
hist(data$Age,
breaks = c(10, 20, 30, 40, 50, 60, 70, 80),
right=FALSE,
xlab="Age",
main="Histogram of Age",
xlim = c(20, 70),
col="cornflowerblue"
)
cat("Right Skewed Graph, Unimodal")
hist(data$Age,
breaks = c(10, 20, 30, 40, 50, 60, 70, 80),
right=FALSE,
xlab="Age",
main="Histogram of Age",
xlim = c(20, 70),
ylim = 2500,
col="cornflowerblue"
)
hist(data$Age,
breaks = c(10, 20, 30, 40, 50, 60, 70, 80),
right=FALSE,
xlab="Age",
main="Histogram of Age",
xlim = c(20, 70),
ylim = 2000,
col="cornflowerblue"
)
hist(data$Age,
breaks = c(10, 20, 30, 40, 50, 60, 70, 80),
right=FALSE,
xlab="Age",
main="Histogram of Age",
xlim = c(20, 70),
ylim = c(2000),
col="cornflowerblue"
)
hist(data$Age,
breaks = c(10, 20, 30, 40, 50, 60, 70, 80),
right=FALSE,
xlab="Age",
main="Histogram of Age",
xlim = c(20, 70),
#ylim = c(2000),
col="cornflowerblue"
)
cat("Right Skewed Graph, Unimodal")
hist(data$Age,
breaks = c(10, 20, 30, 40, 50, 60, 70, 80),
right=FALSE,
xlab="Age",
main="Histogram of Age",
xlim = c(20, 70),
ylim = c(0, 2200),
col="cornflowerblue"
)
cat("Right Skewed Graph, Unimodal")
hist(data$Age,
breaks = c(10, 20, 30, 40, 50, 60, 70, 80),
right=FALSE,
xlab="Age",
main="Histogram of Age",
xlim = c(20, 70),
ylim = c(0, 1800),
col="cornflowerblue"
)
cat("Right Skewed Graph, Unimodal")
hist(data$Age,
breaks = c(10, 20, 30, 40, 50, 60, 70, 80),
right=FALSE,
xlab="Age",
main="Histogram of Age",
xlim = c(20, 70),
ylim = c(0, 1800),
col="cornflowerblue"
)
cat("Right Skewed Graph, Unimodal")
hist(data$Age,
breaks = c(10, 20, 30, 40, 50, 60, 70, 80),
right=FALSE,
xlab="Age",
main="Histogram of Age",
xlim = c(20, 70),
ylim = c(0, 2000),
col="cornflowerblue"
)
cat("Right Skewed Graph, Unimodal")
hist(data$Age,
breaks = c(10, 20, 30, 40, 50, 60, 70, 80),
right=FALSE,
xlab="Age",
main="Number of people in different age groups",
xlim = c(20, 70),
ylim = c(0, 2000),
col="cornflowerblue"
)
cat("Right Skewed Graph, Unimodal")
l <- tapply(data$MonthlyIncome, cut(data$Age, seq(9, 70, by=10)), mean)
which.max(l)
salary_max <- filter(data, Age <=49, Age>=40)
max_salary <- head(salary_max[unique(order(salary_max$MonthlyIncome, decreasing = TRUE)), ], n=5)
max_salary[c("EmployeeID", "MonthlyIncome", "TotalWorkingYears")]
l <- tapply(data$MonthlyIncome, cut(data$Age, seq(19, 70, by=10)), mean)
which.max(l)
salary_max <- filter(data, Age <=49, Age>=40)
max_salary <- head(salary_max[unique(order(salary_max$MonthlyIncome, decreasing = TRUE)), ], n=5)
max_salary[c("EmployeeID", "MonthlyIncome", "TotalWorkingYears")]
l <- tapply(data$MonthlyIncome, cut(data$Age, seq(19, 70, by=10)), mean)
cat("Max Monthly Income Average is in ", which.max(l), " age group.")
salary_max <- filter(data, Age <=49, Age>=40)
max_salary <- head(salary_max[unique(order(salary_max$MonthlyIncome, decreasing = TRUE)), ], n=5)
max_salary[c("EmployeeID", "MonthlyIncome", "TotalWorkingYears")]
l <- tapply(data$MonthlyIncome, cut(data$Age, seq(19, 70, by=10)), mean)
cat("Max Monthly Income Average is in ")
which.max(l)
salary_max <- filter(data, Age <=49, Age>=40)
max_salary <- head(salary_max[unique(order(salary_max$MonthlyIncome, decreasing = TRUE)), ], n=5)
max_salary[c("EmployeeID", "MonthlyIncome", "TotalWorkingYears")]
library(plyr)
z <- ddply(salary_max, .(JobRole), summarize,  Average=mean(MonthlyIncome))
par(mar=c(7,4,4,2)+0.1,mgp=c(4,1,0))
barplot(z$Average, names.arg = z$JobRole, ylab="Average Monthly Income", main = "Job Role Vs Average Salary", cex.names=0.6, las=2, col ="cornflowerblue")
library(plyr)
z <- ddply(salary_max, .(JobRole), summarize,  Average=mean(MonthlyIncome))
par(mar=c(7,4,4,2)+0.1,mgp=c(4,1,0))
barplot(z$Average, names.arg = z$JobRole, ylab="Average Monthly Income", main = "Job Role Vs Average Salary", cex.names=0.6, las=2, col ="cornflowerblue", ylim=c(0, 10000))
library(plyr)
z <- ddply(salary_max, .(JobRole), summarize,  Average=mean(MonthlyIncome))
par(mar=c(7,4,4,2)+0.1,mgp=c(4,1,0))
barplot(z$Average, names.arg = z$JobRole, ylab="Average Monthly Income", main = "Job Role Vs Average Salary", cex.names=0.6, las=2, col ="cornflowerblue")
library(dplyr)
female_data <- filter(data, Gender=="Female")
d1 <- female_data %>% select(MaritalStatus, EnvironmentSatisfaction)
l1 = unique(d1$EnvironmentSatisfaction)
new_data1 <- table(d1$MaritalStatus, d1$EnvironmentSatisfaction)
cols <- c("red", "blue", "green")
barplot(new_data1, main="Environment Satisfaction in Females", col=cols,
xlab="Environment Satisfaction",
beside=TRUE)
legend("topleft",
title="Marital Status",
legend=c(rownames(new_data1)),
fill=cols
)
library(dplyr)
female_data <- filter(data, Gender=="Female")
d1 <- female_data %>% select(MaritalStatus, EnvironmentSatisfaction)
l1 = unique(d1$EnvironmentSatisfaction)
new_data1 <- table(d1$MaritalStatus, d1$EnvironmentSatisfaction)
cols <- c("red", "blue", "green")
barplot(new_data1, main="Environment Satisfaction in Females", col=cols,
xlab="Environment Satisfaction", ylim = 3000,
beside=TRUE)
library(dplyr)
female_data <- filter(data, Gender=="Female")
d1 <- female_data %>% select(MaritalStatus, EnvironmentSatisfaction)
l1 = unique(d1$EnvironmentSatisfaction)
new_data1 <- table(d1$MaritalStatus, d1$EnvironmentSatisfaction)
cols <- c("red", "blue", "green")
barplot(new_data1, main="Environment Satisfaction in Females", col=cols,
xlab="Environment Satisfaction", ylim = c(0, 3000),
beside=TRUE)
legend("topleft",
title="Marital Status",
legend=c(rownames(new_data1)),
fill=cols
)
library(dplyr)
female_data <- filter(data, Gender=="Female")
d1 <- female_data %>% select(MaritalStatus, EnvironmentSatisfaction)
l1 = unique(d1$EnvironmentSatisfaction)
new_data1 <- table(d1$MaritalStatus, d1$EnvironmentSatisfaction)
cols <- c("red", "blue", "green")
barplot(new_data1, main="Environment Satisfaction in Females", col=cols,
xlab="Environment Satisfaction",
beside=TRUE)
legend("topleft",
title="Marital Status",
legend=c(rownames(new_data1)),
fill=cols
)
library(dplyr)
female_data <- filter(data, Gender=="Female")
d1 <- female_data %>% select(MaritalStatus, EnvironmentSatisfaction)
l1 = unique(d1$EnvironmentSatisfaction)
new_data1 <- table(d1$MaritalStatus, d1$EnvironmentSatisfaction)
cols <- c("red", "blue", "green")
barplot(new_data1, main="Environment Satisfaction in Females", col=cols,
xlab="Environment Satisfaction", ylim=c(0, 300),
beside=TRUE)
legend("topleft",
title="Marital Status",
legend=c(rownames(new_data1)),
fill=cols
)
library(dplyr)
d1 <- data %>% select(Attrition, Department)
z = list()
dept_list = unique(d1$Department)
for (variable in dept_list) {
x <- filter(d1, Department==variable)
n  = nrow(x)
y <- filter(x, Attrition=="Yes")
attrition = nrow(y)
z[variable] = attrition/n
}
print("Least Attrition=")
which.min(z)
library(dplyr)
d1 <- data %>% select(Attrition, Department)
z = list()
dept_list = unique(d1$Department)
for (variable in dept_list) {
x <- filter(d1, Department==variable)
n  = nrow(x)
y <- filter(x, Attrition=="Yes")
attrition = nrow(y)
z[variable] = attrition/n
}
cat("Least Attrition=", which.min(z))
library(dplyr)
d1 <- data %>% select(Attrition, Department)
z = list()
dept_list = unique(d1$Department)
for (variable in dept_list) {
x <- filter(d1, Department==variable)
n  = nrow(x)
y <- filter(x, Attrition=="Yes")
attrition = nrow(y)
z[variable] = attrition/n
}
cat("Least Attrition=")
which.min(z)
library(dplyr)
d1 <- data %>% select(Attrition, Department)
z = list()
dept_list = unique(d1$Department)
for (variable in dept_list) {
x <- filter(d1, Department==variable)
n  = nrow(x)
y <- filter(x, Attrition=="Yes")
attrition = nrow(y)
z[variable] = attrition/n
}
cat("Least Attrition is in department ")
which.min(z)
library(dplyr)
Modes <- function(x) {
ux <- unique(x)
tab <- tabulate(match(x, ux))
ux[tab == max(tab)]
}
d1 <- data %>% select(EducationField, MonthlyIncome)
par(mar=c(5,6,1,0)+0.1,mgp=c(4,1,0))
par(cex.axis=0.6)
boxplot(MonthlyIncome ~ EducationField, data = d1, ylab = "Monthly Income", main = "Box Plots for Monthly Income ", boxwex=0.3, las=2, cex.names=0.2)
education_fields = unique(data$EducationField)
d1 <- data %>% select(EducationField, MonthlyIncome, Gender)
for(variable in education_fields)
{
x <- filter(d1, EducationField==variable)
print(variable)
print(summary(x$MonthlyIncome))
cat("Modes = ", Modes(x$MonthlyIncome), "\n")
cat("IQR = ", IQR(x$MonthlyIncome), "\n\n")
}
d2 <- data %>% select(Gender, MonthlyIncome)
par(mar=c(5,6,0,0)+0.1,mgp=c(4,1,0))
boxplot(MonthlyIncome ~ Gender, data = d2, xlab = "Gender",
ylab = "Monthly Income", main = "B", cex.names=0.3, las=2)
print("As seen from the box plot, the gender wage gap isn't prominent. The median pay for both male and female is slightly higher in women by 280. The Mean salary for men is greater than the mean salary for women by 724.")
men <- filter(d2, Gender=="Male")
summary(men$MonthlyIncome)
women <- filter(d2, Gender=="Female")
summary(women$MonthlyIncome)
x <- filter(d1, EducationField=="Medical")
print(quantile(x$MonthlyIncome, c(.95)))
library(moments)
library(PerformanceAnalytics)
hist(data$MonthlyIncome)
print("Skewness is a measure of the symmetry in a distribution.  A symmetrical dataset will have a skewness equal to 0.  So, a normal distribution will have a skewness of 0. The histogram given below is positively skewed.")
skewness(data$MonthlyIncome)
print("Kurtosis is a measure of the combined sizes of the two tails.  It measures the amount of probability in the tails.  The value is often compared to the kurtosis of the normal distribution, which is equal to 3.  If the kurtosis is greater than 3, then the dataset has heavier tails than a normal distribution (more in the tails).  If the kurtosis is less than 3, then the dataset has lighter tails than a normal distribution (less in the tails).")
kurtosis(data$MonthlyIncome)
library(moments)
library(PerformanceAnalytics)
hist(data$MonthlyIncome)
print("Skewness is a measure of the symmetry in a distribution.  A symmetrical dataset will have a skewness equal to 0.  So, a normal distribution will have a skewness of 0. The histogram given below is positively skewed.")
skewness(data$MonthlyIncome)
print("Kurtosis is a measure of the combined sizes of the two tails.  It measures the amount of probability in the tails.  The value is often compared to the kurtosis of the normal distribution, which is equal to 3.  If the kurtosis is greater than 3, then the dataset has heavier tails than a normal distribution (more in the tails).  If the kurtosis is less than 3, then the dataset has lighter tails than a normal distribution (less in the tails).")
kurtosis(data$MonthlyIncome)
print("Kurtosis is a measure of the combined sizes of the two tails.  It measures the amount of probability in the tails. The kurtosis for a standard normal distribution is three. positive kurtosis indicates a \"heavy-tailed\" distribution and negative kurtosis indicates a \"light tailed\" distribution.")
kurtosis(data$MonthlyIncome)
